
uvicorn src.api.main:app --host 0.0.0.0 --port 8000

http://127.0.0.1:8000/health/env  ---环境检查
http://127.0.0.1:8000/action/qvx_max_and_top   -- 置顶并最大化
http://127.0.0.1:8000/action/send   -- 发送消息动作（加了仿真）

我要给RPA开发一些http后台接口，用于操控企业微信
写代码前，我先表达下我的偏好
a. 需要用中文给我交互
b. 代码要满足设计模式的，开闭原则，新功能增加以新增py文件为主，尽量避免代码里有一堆的if嵌套
c. 代码是给初级程序员维护的，所以不要做多行合并到1行，这种是严令禁止的，代码要有注释，代码要用简单的语法表达
d. 所有功能函数，必须给我设计测试用例，测试用例包括正，负向用例


1. env_check
   功能：检查运行环境是否符合要求。条件包括：【操作系统类型校验- 包括windows server系列，win10，win11】【企业微信要已经启动】是and关系
   输入：无
   输出：
        参数1 boolean类型，是否符合最小可用的标准
        参数2 字典类型， 环境描述
          【key1-屏幕分辨率】    屏幕实际分辨率 例如: [1920,1080]
          【key2-操作系统类型】 操作系统实际类型，需要到具体，例如 win10，win11，winserver2003
          【key3-企微是否启动】 已安装-启动，已安装-未启动，未安装
           【key4-本次检查桌面截图位置】需要对当前桌面进行截图，便于后续分析



2.qvx_position  
   功能：定位各种元素，的box（元素所在屏幕的4点矩形坐标）
   做法：项目目录增加1个template，按常见屏幕分辨率，设置目录 例如 1920-1200  ，800-600，你来帮我扩展，我是按env实际分辨率，在这些目录里找模版，用opencv做以图搜图
   输入：
            参数1：标的物  例如  消息输入框，消息发送按钮，等  
                     
   输出：
           参数1： bbox ，列表-包括左上坐标，宽，高

3. qvx_action_sendmsg
    功能：找到input输入框，使用alt+s 或者  点击发送按钮,如果是用点击，需要采用仿真模式移动鼠标。
    仿真代码我已经写好了，在
    输入：无
    输出：
         参数1 ：boolean 类型  反应动作是否执行
         参数2： 发送完毕后，需要截图，保留日志  （依赖全局参数  screen_send_msg_after ）  


4. 企业微信客户端，做了风控，对于rpa会有风控，我做了基于profile的键盘鼠标仿真
    代码都在rpa代码目录里，你先给我生成空目录，后面我copy进来，你再理解，然后用于 qvx_action_sendmsg


5. qvx_max_and_top
    功能：把企业微信最大化并置顶
    输入：无
    输出：
        参数1： 截图位置  （依赖全局参数  screen_max_and_top ）  

